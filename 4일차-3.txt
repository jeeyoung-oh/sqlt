
conn tuning/tuning
alter session set statistics_level=all; 
exec clean_index

CREATE INDEX customers_birthdate_idx ON customers(birthdate);						
CREATE INDEX orders_paytype_status_idx ON orders(paytype, status);						
CREATE INDEX orderdetails_prodno_idx ON orderdetails(prodno);						

--1)
SELECT /*+ USE_HASH(c o) LEADING(d o c) NO_SWAP_JOIN_INPUTS(c) */ c.city, o.paytype, o.status, SUM(d.qty)
FROM customers c, orders o, orderdetails d	
WHERE c.custno = o.custno										
AND o.orderno = d.orderno										
GROUP BY c.city, o.paytype, o.status;										

@c:\sqlt\xplan

--2)
SELECT /*+ USE_HASH(o d) LEADING(c o d) NO_SWAP_JOIN_INPUTS(d) */ c.city, o.paytype, o.status, SUM(d.qty)
FROM customers c, orders o, orderdetails d	
WHERE c.custno = o.custno										
AND o.orderno = d.orderno										
GROUP BY c.city, o.paytype, o.status;										

@c:\sqlt\xplan
